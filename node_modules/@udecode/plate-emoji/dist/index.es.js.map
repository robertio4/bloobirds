{"version":3,"file":"index.es.js","sources":["../src/types.ts","../src/constants.ts","../src/utils/EmojiObserver.ts","../src/utils/EmojiTriggeringController.ts","../src/utils/Grid/Grid.ts","../src/utils/Grid/GridSection.ts","../src/utils/EmojiLibrary/EmojiFloatingGrid.ts","../src/utils/EmojiLibrary/EmojiFloatingGridBuilder.ts","../src/utils/EmojiLibrary/EmojiInlineLibrary.ts","../src/utils/EmojiLibrary/EmojiFloatingLibrary.ts","../src/utils/EmojiPicker/EmojiPickerState.ts","../src/handlers/getEmojiOnInsert.ts","../src/utils/EmojiPicker/useEmojiPicker.ts","../src/utils/IndexSearch/IndexSearch.ts","../src/utils/IndexSearch/EmojiFloatingIndexSearch.ts","../src/utils/IndexSearch/EmojiInlineIndexSearch.ts","../src/handlers/getEmojiOnSelectItem.ts","../src/handlers/getFindTriggeringInput.ts","../../../../node_modules/is-hotkey/lib/index.js","../src/handlers/getOnKeyDownEmoji.ts","../src/withEmoji.ts","../src/createEmojiPlugin.ts","../src/storage/LocalStorage.ts","../src/storage/FrequentEmojiStorage.ts"],"sourcesContent":["import { TComboboxItem } from '@udecode/plate-combobox';\nimport { TEditableProps, Value } from '@udecode/plate-core';\nimport { IEmojiTriggeringController } from './utils';\n\ntype ReverseMap<T> = T[keyof T];\n\nexport type EmojiSettingsType = {\n  buttonSize: {\n    value: number;\n  };\n  categories: {\n    value?: EmojiCategoryList[];\n  };\n  perLine: {\n    value: number;\n  };\n  showFrequent: {\n    value: boolean;\n    limit?: number;\n    key?: string;\n    prefix?: string;\n  };\n};\n\nexport type EmojiComboboxProps = (\n  editableProps: TEditableProps<Value>\n) => JSX.Element | null;\n\nexport type EmojiItemData = {\n  id: string;\n  emoji: string;\n  name: string;\n  text: string;\n};\n\nexport interface CreateEmoji<TData extends EmojiItemData = EmojiItemData> {\n  (data: TComboboxItem<TData>): string;\n}\n\nexport interface EmojiPlugin<TData extends EmojiItemData = EmojiItemData> {\n  trigger?: string;\n  createEmoji?: CreateEmoji<TData>;\n  emojiTriggeringController?: IEmojiTriggeringController;\n  id?: string;\n}\n\nexport const EmojiCategory = {\n  Activity: 'activity',\n  Custom: 'custom',\n  Flags: 'flags',\n  Foods: 'foods',\n  Frequent: 'frequent',\n  Nature: 'nature',\n  Objects: 'objects',\n  People: 'people',\n  Places: 'places',\n  Symbols: 'symbols',\n} as const;\n\nexport type EmojiCategoryList = ReverseMap<typeof EmojiCategory>;\n\nexport type i18nProps = {\n  search: string;\n  searchResult: string;\n  clear: string;\n  searchNoResultsTitle: string;\n  searchNoResultsSubtitle: string;\n  pick: string;\n  categories: Record<EmojiCategoryList, string>;\n  skins: Record<'choose' | '1' | '2' | '3' | '4' | '5' | '6', string>;\n};\n\nexport type EmojiIconList<T = string> = {\n  categories: Record<EmojiCategoryList, { outline: T; solid: T }>;\n  search: {\n    loupe: T;\n    delete: T;\n  };\n};\n","import {\n  EmojiCategory,\n  EmojiCategoryList,\n  EmojiSettingsType,\n  i18nProps,\n} from './types';\nimport { EmojiTriggeringControllerOptions, FrequentEmojis } from './utils';\n\nexport const KEY_EMOJI = 'emoji';\n\nexport const EMOJI_TRIGGER = ':';\nexport const EMOJI_MAX_SEARCH_RESULT = 60;\n\nexport const EMOJI_TRIGGERING_CONTROLLER_OPTIONS: EmojiTriggeringControllerOptions = {\n  limitTriggeringChars: 3,\n  maxTextToSearch: 30,\n};\n\nexport const defaultCategories: EmojiCategoryList[] = [\n  EmojiCategory.People,\n  EmojiCategory.Nature,\n  EmojiCategory.Foods,\n  EmojiCategory.Activity,\n  EmojiCategory.Places,\n  EmojiCategory.Objects,\n  EmojiCategory.Symbols,\n  EmojiCategory.Flags,\n];\n\nexport const EmojiSettings: EmojiSettingsType = {\n  buttonSize: {\n    value: 36,\n  },\n  perLine: {\n    value: 8,\n  },\n  showFrequent: {\n    value: true,\n    limit: 16,\n  },\n  categories: {\n    value: undefined,\n  },\n};\n\nexport const DEFAULT_FREQUENTLY_USED_EMOJI: FrequentEmojis = {\n  '+1': 1,\n  grinning: 1,\n  kissing_heart: 1,\n  heart_eyes: 1,\n  pray: 1,\n  laughing: 1,\n  clap: 1,\n  joy: 1,\n  scream: 1,\n  rocket: 1,\n  see_no_evil: 1,\n  hugging_face: 1,\n  heart: 1,\n};\n\nexport const NUM_OF_CATEGORIES = Object.values(EmojiCategory).length;\n\nexport const i18n: i18nProps = {\n  search: 'Search all emoji',\n  clear: 'Clear',\n  searchNoResultsTitle: 'Oh no!',\n  searchNoResultsSubtitle: 'That emoji couldnâ€™t be found',\n  pick: 'Pick an emoji...',\n  searchResult: 'Search Results',\n  categories: {\n    activity: 'Activity',\n    custom: 'Custom',\n    flags: 'Flags',\n    foods: 'Food & Drink',\n    frequent: 'Frequently used',\n    nature: 'Animals & Nature',\n    objects: 'Objects',\n    people: 'Smileys & People',\n    places: 'Travel & Places',\n    symbols: 'Symbols',\n  },\n  skins: {\n    choose: 'Choose default skin tone',\n    '1': 'Default',\n    '2': 'Light',\n    '3': 'Medium-Light',\n    '4': 'Medium',\n    '5': 'Medium-Dark',\n    '6': 'Dark',\n  },\n};\n","import { MutableRefObject } from 'react';\nimport { EmojiCategoryList } from '../types';\nimport { IEmojiFloatingLibrary } from './EmojiLibrary';\nimport { MapEmojiCategoryList } from './EmojiPicker';\n\nconst setVisibleSections = (\n  entries: IntersectionObserverEntry[],\n  visibleSections: MapEmojiCategoryList\n) => {\n  for (const entry of entries) {\n    const id = (entry.target as HTMLDivElement).dataset.id as EmojiCategoryList;\n    visibleSections.set(id, entry.isIntersecting);\n  }\n};\n\nconst getSectionInFocus = (\n  visibleSections: MapEmojiCategoryList\n): EmojiCategoryList | undefined => {\n  for (const [id, ratio] of visibleSections) {\n    if (ratio) {\n      return id;\n    }\n  }\n};\n\nexport type SetFocusedAndVisibleSectionsType = (\n  visibleSections: MapEmojiCategoryList,\n  categoryId?: EmojiCategoryList\n) => void;\n\nexport type ObserverCategoriesType = {\n  ancestorRef: MutableRefObject<HTMLDivElement | null>;\n  emojiLibrary: IEmojiFloatingLibrary;\n  setFocusedAndVisibleSections: SetFocusedAndVisibleSectionsType;\n};\n\nexport const observeCategories = ({\n  ancestorRef,\n  emojiLibrary,\n  setFocusedAndVisibleSections,\n}: ObserverCategoriesType) => {\n  const observerOptions = {\n    root: ancestorRef.current,\n    threshold: 0,\n  };\n\n  const visibleSections: MapEmojiCategoryList = new Map();\n\n  const observer = new IntersectionObserver((entries) => {\n    setVisibleSections(entries, visibleSections);\n    const focusedSectionId = getSectionInFocus(visibleSections);\n\n    setFocusedAndVisibleSections(visibleSections, focusedSectionId);\n  }, observerOptions);\n\n  for (const section of emojiLibrary.getGrid().sections()) {\n    if (section.root.current) observer.observe(section.root.current);\n  }\n\n  return observer;\n};\n","import { EMOJI_TRIGGERING_CONTROLLER_OPTIONS } from '../constants';\nimport {\n  EmojiTriggeringControllerOptions,\n  IEmojiTriggeringController,\n} from './EmojiTriggeringController.types';\n\nexport class EmojiTriggeringController implements IEmojiTriggeringController {\n  protected text = '';\n  protected pos: any;\n  public isTriggering = false;\n  public hasTriggeringMark = false;\n\n  constructor(\n    protected trigger = ':',\n    protected options: EmojiTriggeringControllerOptions = EMOJI_TRIGGERING_CONTROLLER_OPTIONS\n  ) {}\n\n  setText(text: string) {\n    this.text = text;\n    this.hasTriggeringMark = this.isWithTriggeringMark(text);\n\n    this.isTriggering =\n      this.hasTriggeringMark &&\n      this.text.length >= this.options.limitTriggeringChars;\n  }\n\n  private isWithTriggeringMark(text: string) {\n    return new RegExp(`^${this.trigger}.*`).test(text);\n  }\n\n  getText() {\n    return this.hasTriggeringMark ? this.text.slice(1) : this.text;\n  }\n\n  getOptions(): EmojiTriggeringControllerOptions {\n    return this.options;\n  }\n\n  getTextSize() {\n    return this.text.length;\n  }\n\n  reset() {\n    this.text = '';\n    this.isTriggering = false;\n    this.hasTriggeringMark = false;\n  }\n}\n","import {\n  GridElements,\n  IGrid,\n  IGridSection,\n  SectionElements,\n  SectionId,\n} from './Grid.types';\n\nexport class Grid<R, T extends SectionId = SectionId> implements IGrid<R, T> {\n  protected rowsCount = 1;\n  protected sectionsIds: T[] = [];\n  protected grid = new Map<T, IGridSection<R, T>>();\n\n  public addSection(\n    sectionId: T,\n    section: IGridSection<R, T>,\n    elements: GridElements\n  ) {\n    section.setIndexRowStart(this.rowsCount).addElements(elements[sectionId]);\n    this.rowsCount += section.rowsNum;\n    this.grid.set(sectionId, section);\n    this.sectionsIds.push(sectionId);\n    return this;\n  }\n\n  public get size() {\n    return this.grid.size;\n  }\n\n  public indexOf(sectionId: T) {\n    return this.sectionsIds.indexOf(sectionId);\n  }\n\n  public sections() {\n    return Array.from(this.grid.values());\n  }\n\n  public section(sectionId: T) {\n    return this.grid.get(sectionId)!;\n  }\n\n  public updateSection(sectionId: T, elements: SectionElements) {\n    if (this.grid.has(sectionId)) {\n      const section = this.grid.get(sectionId);\n      section!.updateElements(elements);\n    }\n\n    return this;\n  }\n}\n","import {\n  GridRows,\n  IGridSection,\n  SectionElements,\n  SectionId,\n  Unknown,\n} from './Grid.types';\n\nexport abstract class AGridSection<R extends Unknown, T = SectionId>\n  implements IGridSection<R, T> {\n  protected rows: GridRows = [];\n  protected _root!: R;\n  protected _rowsNum = 0;\n  protected _indexRowStart = 0;\n\n  constructor(protected _id: T, protected perLine = 8) {\n    this.createRootRef();\n  }\n\n  protected abstract createRootRef(): void;\n\n  public setIndexRowStart(start: number) {\n    this._indexRowStart = start;\n    return this;\n  }\n\n  public addElements(elements: SectionElements) {\n    this._rowsNum = Math.ceil(elements.length / this.perLine);\n    this.initRows(elements);\n\n    return this;\n  }\n\n  public updateElements(elements: SectionElements) {\n    this.rows = [];\n    this.addElements(elements);\n    return this;\n  }\n\n  private initRows(elements: SectionElements) {\n    let i = 0;\n    while (i < this.rowsNum) {\n      this.addRow(elements, i++);\n    }\n  }\n\n  private addRow(elements: SectionElements, lastPosition: number) {\n    const start = lastPosition * this.perLine;\n    const end = start + this.perLine;\n    this.rows.push({\n      elements: elements.slice(start, end),\n      id: this._indexRowStart + lastPosition,\n    });\n  }\n\n  get rowsNum() {\n    return this._rowsNum;\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  get root(): R {\n    return this._root;\n  }\n\n  getRows() {\n    return this.rows;\n  }\n}\n","import { createRef, RefObject } from 'react';\nimport { EmojiCategoryList } from '../../types';\nimport { AGridSection, Grid } from '../Grid';\n\nexport class EmojiFloatingGrid extends Grid<\n  RefObject<HTMLDivElement>,\n  EmojiCategoryList\n> {\n  public createRootRef() {\n    return createRef<HTMLDivElement>();\n  }\n}\n\nexport class EmojiGridSectionWithRoot extends AGridSection<\n  RefObject<HTMLDivElement>,\n  EmojiCategoryList\n> {\n  protected createRootRef() {\n    this._root = createRef<HTMLDivElement>();\n  }\n}\n","import { EmojiCategoryList, EmojiSettingsType } from '../../types';\nimport { GridElements } from '../Grid';\nimport {\n  EmojiFloatingGrid,\n  EmojiGridSectionWithRoot,\n} from './EmojiFloatingGrid';\nimport { IFrequentEmojiStorage } from './EmojiFloatingLibrary.types';\n\nexport class EmojiFloatingGridBuilder {\n  protected grid = new EmojiFloatingGrid();\n\n  constructor(\n    protected localStorage: IFrequentEmojiStorage,\n    protected sections: EmojiCategoryList[],\n    protected elements: GridElements,\n    protected settings: EmojiSettingsType\n  ) {}\n\n  private addFrequent() {\n    if (this.settings.showFrequent.value) {\n      const id = 'frequent';\n      this.grid.addSection(\n        id,\n        new EmojiGridSectionWithRoot(id, this.settings.perLine.value),\n        {\n          [id]: this.localStorage.getList(),\n        }\n      );\n    }\n  }\n\n  public build() {\n    this.addFrequent();\n\n    this.sections.forEach((id) => {\n      this.grid.addSection(\n        id,\n        new EmojiGridSectionWithRoot(id, this.settings.perLine.value),\n        this.elements\n      );\n    });\n\n    return this.grid;\n  }\n}\n","import emojiMartData from '@emoji-mart/data';\nimport { THash } from './EmojiInlineLibrary.types';\nimport {\n  Emoji,\n  EmojiLibrary,\n  Emojis,\n  IEmojiLibrary,\n} from './EmojiLibrary.types';\n\nexport class EmojiInlineLibrary implements IEmojiLibrary {\n  protected _hash: THash = {};\n  protected _keys: string[] = [];\n  protected _emojis: Emojis;\n\n  constructor(library: EmojiLibrary = emojiMartData) {\n    this._emojis = library.emojis;\n    this.init();\n  }\n\n  private init() {\n    Object.values(this._emojis).forEach((emoji) => {\n      const searchableString = this.createSearchableString(emoji);\n      this._keys.push(searchableString);\n      this._hash[searchableString] = emoji.id;\n    });\n  }\n\n  private createSearchableString(emoji: Emoji) {\n    const { id, name, keywords } = emoji;\n    return `${id},${this.getName(name)},${keywords.join(',')}`;\n  }\n\n  private getName(name: string) {\n    return name.toLowerCase().split(' ').join(',');\n  }\n\n  get keys(): string[] {\n    return this._keys;\n  }\n\n  getEmoji(id: string) {\n    return this._emojis[id];\n  }\n\n  getEmojiId(key: string) {\n    return this._hash[key];\n  }\n}\n","import emojiMartData from '@emoji-mart/data';\nimport { defaultCategories } from '../../constants';\nimport {\n  EmojiCategory,\n  EmojiCategoryList,\n  EmojiSettingsType,\n} from '../../types';\nimport { EmojiFloatingGridType } from './EmojiFloatingGrid.types';\nimport { EmojiFloatingGridBuilder } from './EmojiFloatingGridBuilder';\nimport {\n  IEmojiFloatingLibrary,\n  IFrequentEmojiStorage,\n} from './EmojiFloatingLibrary.types';\nimport { EmojiInlineLibrary } from './EmojiInlineLibrary';\nimport { EmojiLibrary } from './EmojiLibrary.types';\n\nexport class EmojiFloatingLibrary\n  extends EmojiInlineLibrary\n  implements IEmojiFloatingLibrary {\n  private static instance?: EmojiFloatingLibrary;\n\n  private categories: EmojiCategoryList[] = defaultCategories;\n  private emojis: Partial<Record<EmojiCategoryList, string[]>> = {};\n  private grid: EmojiFloatingGridType;\n\n  private constructor(\n    protected settings: EmojiSettingsType,\n    protected localStorage: IFrequentEmojiStorage,\n    protected library: EmojiLibrary = emojiMartData\n  ) {\n    super(library);\n\n    this.categories = settings.categories.value ?? this.categories;\n\n    this.initEmojis(library.categories);\n\n    this.grid = new EmojiFloatingGridBuilder(\n      this.localStorage,\n      this.categories,\n      this.emojis,\n      settings\n    ).build();\n  }\n\n  public static getInstance(\n    settings: EmojiSettingsType,\n    localStorage: IFrequentEmojiStorage,\n    library: EmojiLibrary = emojiMartData\n  ) {\n    if (!EmojiFloatingLibrary.instance) {\n      EmojiFloatingLibrary.instance = new EmojiFloatingLibrary(\n        settings,\n        localStorage,\n        library\n      );\n    }\n\n    return EmojiFloatingLibrary.instance;\n  }\n\n  private initEmojis(categoriesLibrary: any) {\n    for (const category of categoriesLibrary) {\n      this.emojis[category.id] = category.emojis;\n    }\n  }\n\n  public updateFrequentCategory(emojiId: string) {\n    this.localStorage.update(emojiId);\n    this.grid.updateSection(\n      EmojiCategory.Frequent,\n      this.localStorage.getList()\n    );\n  }\n\n  public getGrid() {\n    return this.grid;\n  }\n\n  public indexOf(focusedCategory: EmojiCategoryList) {\n    const index = this.grid.indexOf(focusedCategory);\n    return index < 1 ? 0 : index;\n  }\n}\n","import { Dispatch, Reducer, useReducer } from 'react';\nimport { EmojiCategory } from '../../types';\nimport {\n  EmojiPickerStateDispatch,\n  EmojiPickerStateProps,\n} from './EmojiPickerState.types';\n\nconst initialState: EmojiPickerStateProps = {\n  isOpen: false,\n  searchValue: '',\n  emoji: undefined,\n  hasFound: false,\n  isSearching: false,\n  searchResult: [],\n  focusedCategory: undefined,\n  visibleCategories: new Map(),\n  frequentEmoji: undefined,\n};\n\nexport const EmojiPickerState = (): [\n  EmojiPickerStateProps,\n  Dispatch<EmojiPickerStateDispatch>\n] => {\n  const [cache, dispatch] = useReducer<\n    Reducer<EmojiPickerStateProps, EmojiPickerStateDispatch>\n  >((state, action) => {\n    const { type, payload } = action;\n\n    switch (type) {\n      case 'CLEAR_SEARCH':\n        return {\n          ...state,\n          searchValue: '',\n          isSearching: false,\n          hasFound: false,\n          focusedCategory: EmojiCategory.Frequent,\n        };\n      case 'UPDATE_SEARCH_RESULT':\n        return {\n          ...state,\n          ...payload,\n          isSearching: true,\n          focusedCategory: undefined,\n        };\n      case 'SET_FOCUSED_CATEGORY':\n        return {\n          ...state,\n          ...payload,\n          searchValue: '',\n          isSearching: false,\n          hasFound: false,\n        };\n      case 'SET_OPEN':\n        return {\n          ...state,\n          isOpen: true,\n        };\n      case 'SET_CLOSE':\n        return {\n          ...state,\n          emoji: undefined,\n          isOpen: false,\n        };\n      case 'UPDATE_FREQUENT_EMOJIS':\n        return {\n          ...state,\n          ...payload,\n          emoji: undefined,\n        };\n      case 'SET_SEARCH':\n      case 'SET_EMOJI':\n      case 'SET_FOCUSED_AND_VISIBLE_CATEGORIES':\n        return { ...state, ...payload };\n      default: {\n        throw new Error(`Unhandled action type: ${type}`);\n      }\n    }\n  }, initialState);\n\n  return [cache, dispatch];\n};\n","import { ComboboxOnSelectItem } from '@udecode/plate-combobox';\nimport {\n  focusEditor,\n  getPlugin,\n  insertText,\n  PlatePluginKey,\n  withoutNormalizing,\n} from '@udecode/plate-core';\nimport { KEY_EMOJI } from '../constants';\nimport { EmojiItemData, EmojiPlugin } from '../types';\n\nexport const getEmojiOnInsert = <TData extends EmojiItemData = EmojiItemData>({\n  key = KEY_EMOJI,\n}: PlatePluginKey = {}): ComboboxOnSelectItem<TData> => (editor, item) => {\n  const {\n    options: { createEmoji },\n  } = getPlugin<EmojiPlugin>(editor as any, key);\n\n  withoutNormalizing(editor, () => {\n    focusEditor(editor);\n\n    const value = createEmoji!(item);\n    insertText(editor, value);\n  });\n};\n","import { createRef, useCallback, useEffect, useRef } from 'react';\nimport { i18n } from '../../constants';\nimport { getEmojiOnInsert } from '../../handlers/getEmojiOnInsert';\nimport { EmojiCategoryList } from '../../types';\nimport { Emoji } from '../EmojiLibrary';\nimport {\n  observeCategories,\n  SetFocusedAndVisibleSectionsType,\n} from '../EmojiObserver';\nimport { EmojiPickerState } from './EmojiPickerState';\nimport {\n  UseEmojiPickerProps,\n  UseEmojiPickerType,\n} from './useEmojiPicker.types';\n\nexport const useEmojiPicker = ({\n  editor,\n  emojiLibrary,\n  indexSearch,\n  closeOnSelect,\n}: UseEmojiPickerProps): Omit<UseEmojiPickerType, 'icons' | 'settings'> => {\n  const [state, dispatch] = EmojiPickerState();\n  const refs = useRef({\n    contentRoot: createRef<HTMLDivElement>(),\n    content: createRef<HTMLDivElement>(),\n  });\n\n  const onToggle = useCallback(() => {\n    dispatch({\n      type: state.isOpen ? 'SET_CLOSE' : 'SET_OPEN',\n    });\n  }, [dispatch, state.isOpen]);\n\n  const setFocusedAndVisibleSections = useCallback<SetFocusedAndVisibleSectionsType>(\n    (visibleSections, categoryId) => {\n      dispatch({\n        type: 'SET_FOCUSED_AND_VISIBLE_CATEGORIES',\n        payload: {\n          focusedCategory: categoryId,\n          visibleCategories: visibleSections,\n        },\n      });\n    },\n    [dispatch]\n  );\n\n  const handleSearchInput = useCallback(\n    (input: string) => {\n      const value = String(input).replace(/\\s/g, '');\n      if (!value && !input) {\n        dispatch({ type: 'CLEAR_SEARCH' });\n        return;\n      }\n\n      const hasFound = indexSearch.search(value).hasFound();\n\n      dispatch({\n        type: 'UPDATE_SEARCH_RESULT',\n        payload: {\n          searchValue: value,\n          hasFound,\n          searchResult: indexSearch.get(),\n        },\n      });\n    },\n    [dispatch, indexSearch]\n  );\n\n  const setSearch = useCallback(\n    (value: string) => {\n      value ? handleSearchInput(value) : dispatch({ type: 'CLEAR_SEARCH' });\n    },\n    [dispatch, handleSearchInput]\n  );\n\n  const clearSearch = useCallback(() => {\n    dispatch({ type: 'CLEAR_SEARCH' });\n  }, [dispatch]);\n\n  const onMouseOver = useCallback(\n    (emoji?: Emoji) => {\n      dispatch({ type: 'SET_EMOJI', payload: { emoji } });\n    },\n    [dispatch]\n  );\n\n  const updateFrequentEmojis = useCallback(\n    (emojiId: string) => {\n      emojiLibrary.updateFrequentCategory(emojiId);\n\n      dispatch({\n        type: 'UPDATE_FREQUENT_EMOJIS',\n        payload: {\n          frequentEmoji: emojiId,\n          isOpen: closeOnSelect ? false : state.isOpen,\n        },\n      });\n    },\n    [closeOnSelect, dispatch, emojiLibrary, state.isOpen]\n  );\n\n  const onSelectEmoji = useCallback(\n    (emoji: Emoji) => {\n      const selectItem = getEmojiOnInsert();\n      selectItem(editor, {\n        key: emoji.id,\n        text: emoji.name,\n        data: {\n          id: emoji.id,\n          emoji: emoji.skins[0].native,\n          name: emoji.name,\n          text: emoji.name,\n        },\n      });\n\n      updateFrequentEmojis(emoji.id);\n    },\n    [editor, updateFrequentEmojis]\n  );\n\n  const handleCategoryClick = useCallback(\n    (categoryId: EmojiCategoryList) => {\n      dispatch({\n        type: 'SET_FOCUSED_CATEGORY',\n        payload: { focusedCategory: categoryId },\n      });\n\n      const getSectionPositionToScrollIntoView = () => {\n        const trashHold = 1;\n        const section = emojiLibrary.getGrid().section(categoryId);\n\n        const contentRootScrollTop =\n          refs.current.contentRoot.current?.scrollTop ?? 0;\n        const contentRootTopPosition =\n          refs.current.contentRoot.current?.getBoundingClientRect().top ?? 0;\n        const sectionTopPosition =\n          section?.root.current?.getBoundingClientRect().top ?? 0;\n\n        return (\n          trashHold +\n          contentRootScrollTop +\n          sectionTopPosition -\n          contentRootTopPosition\n        );\n      };\n\n      if (refs.current.contentRoot.current) {\n        refs.current.contentRoot.current.scrollTop = getSectionPositionToScrollIntoView();\n      }\n    },\n    [dispatch, emojiLibrary]\n  );\n\n  useEffect(() => {\n    if (state.isOpen && !state.isSearching) {\n      observeCategories({\n        ancestorRef: refs.current.contentRoot,\n        emojiLibrary,\n        setFocusedAndVisibleSections,\n      });\n    }\n  }, [\n    emojiLibrary,\n    state.isOpen,\n    state.isSearching,\n    setFocusedAndVisibleSections,\n  ]);\n\n  return {\n    onToggle,\n    i18n,\n    setSearch,\n    clearSearch,\n    emoji: state.emoji,\n    onMouseOver,\n    onSelectEmoji,\n    emojiLibrary,\n    handleCategoryClick,\n    refs,\n    ...state,\n  };\n};\n","import { TComboboxItem } from '@udecode/plate-combobox';\nimport { EMOJI_MAX_SEARCH_RESULT } from '../../constants';\nimport { EmojiItemData } from '../../types';\nimport { Emoji, IEmojiLibrary } from '../EmojiLibrary';\n\ntype IndexSearchReturnData = TComboboxItem<EmojiItemData>;\n\ninterface IIndexSearch<R> {\n  search: (input: string) => void;\n  hasFound: () => boolean;\n  get: () => R[];\n}\n\nexport abstract class AIndexSearch<RData = IndexSearchReturnData>\n  implements IIndexSearch<RData> {\n  protected result: string[] = [];\n  protected scores = {};\n  protected maxResult = EMOJI_MAX_SEARCH_RESULT;\n\n  protected constructor(protected library: IEmojiLibrary) {}\n\n  search(input: string): this {\n    const value = input.toLowerCase();\n\n    if (value) {\n      this.createSearchResult(value);\n      this.sortResultByScores(this.result, this.scores);\n    } else {\n      this.scores = {};\n      this.result = [];\n    }\n\n    return this;\n  }\n\n  private createSearchResult(value: string) {\n    this.scores = {};\n    this.result = [];\n\n    for (const key of this.library!.keys) {\n      const score = key.indexOf(`${value}`);\n      if (score === -1) continue;\n\n      const emojiId = this.library!.getEmojiId(key);\n      this.result.push(emojiId);\n\n      this.scores[emojiId] || (this.scores[emojiId] = 0);\n      this.scores[emojiId] += emojiId === value ? 0 : score + 1;\n    }\n  }\n\n  private sortResultByScores(result: string[], scores: {}) {\n    result.sort((a, b) => {\n      const aScore = scores[a];\n      const bScore = scores[b];\n\n      if (aScore === bScore) {\n        return a.localeCompare(b);\n      }\n\n      return aScore - bScore;\n    });\n  }\n\n  hasFound() {\n    return !!this.result.length;\n  }\n\n  get() {\n    const emojis = [];\n    for (const key of this.result) {\n      const emoji = this.library?.getEmoji(key);\n      emojis.push(this.transform(emoji!));\n      if (emojis.length >= this.maxResult) break;\n    }\n    return emojis;\n  }\n\n  protected abstract transform(emoji: Emoji): RData;\n}\n","import { Emoji, IEmojiLibrary } from '../EmojiLibrary';\nimport { AIndexSearch } from './IndexSearch';\n\nexport class EmojiFloatingIndexSearch extends AIndexSearch<Emoji> {\n  protected static instance?: EmojiFloatingIndexSearch;\n\n  private constructor(protected library: IEmojiLibrary) {\n    super(library);\n  }\n\n  public static getInstance(library: IEmojiLibrary) {\n    if (!EmojiFloatingIndexSearch.instance) {\n      EmojiFloatingIndexSearch.instance = new EmojiFloatingIndexSearch(library);\n    }\n\n    return EmojiFloatingIndexSearch.instance;\n  }\n\n  protected transform(emoji: Emoji) {\n    return emoji;\n  }\n}\n","import { Emoji, EmojiInlineLibrary, IEmojiLibrary } from '../EmojiLibrary';\nimport { AIndexSearch } from './IndexSearch';\n\nexport class EmojiInlineIndexSearch extends AIndexSearch {\n  protected static instance?: EmojiInlineIndexSearch;\n\n  private constructor(protected library: IEmojiLibrary) {\n    super(library);\n  }\n\n  public static getInstance() {\n    if (!EmojiInlineIndexSearch.instance) {\n      EmojiInlineIndexSearch.instance = new EmojiInlineIndexSearch(\n        new EmojiInlineLibrary()\n      );\n    }\n\n    return EmojiInlineIndexSearch.instance;\n  }\n\n  protected transform(emoji: Emoji) {\n    const { id, name, skins } = emoji;\n\n    return {\n      key: id,\n      text: name,\n      data: {\n        id,\n        emoji: skins[0].native,\n        name,\n        text: name,\n      },\n    };\n  }\n}\n","import { comboboxActions, ComboboxOnSelectItem } from '@udecode/plate-combobox';\nimport {\n  deleteText,\n  getPlugin,\n  insertText,\n  PlatePluginKey,\n  withoutMergingHistory,\n  withoutNormalizing,\n} from '@udecode/plate-core';\nimport { KEY_EMOJI } from '../constants';\nimport { EmojiItemData, EmojiPlugin } from '../types';\n\nexport const getEmojiOnSelectItem = <\n  TData extends EmojiItemData = EmojiItemData\n>({ key = KEY_EMOJI }: PlatePluginKey = {}): ComboboxOnSelectItem<TData> => (\n  editor,\n  item\n) => {\n  const {\n    options: { createEmoji, emojiTriggeringController },\n  } = getPlugin<EmojiPlugin>(editor as any, key);\n\n  withoutNormalizing(editor, () => {\n    withoutMergingHistory(editor, () =>\n      deleteText(editor, {\n        distance: emojiTriggeringController!.getTextSize(),\n        reverse: true,\n      })\n    );\n    emojiTriggeringController!.reset();\n\n    const value = createEmoji!(item);\n    insertText(editor, value);\n  });\n\n  return comboboxActions.reset();\n};\n","import {\n  getEditorString,\n  getPointBefore,\n  getRange,\n  PlateEditor,\n  Value,\n} from '@udecode/plate-core';\nimport { BasePoint, BaseRange } from 'slate';\nimport { IEmojiTriggeringController } from '../utils';\n\nconst getNextPoint = <V extends Value>(\n  editor: PlateEditor<V>,\n  endPoint: BasePoint\n) =>\n  getPointBefore(editor, endPoint, {\n    unit: 'character',\n    distance: 1,\n  });\n\nconst getFoundText = <V extends Value>(\n  editor: PlateEditor<V>,\n  start: BaseRange,\n  end?: BasePoint\n) => getEditorString(editor, getRange(editor, start, end));\n\nconst isBreakingCharInText = (text: string) => /^\\s/.test(text);\n\nexport const getFindTriggeringInput = <V extends Value>(\n  editor: PlateEditor<V>,\n  emojiTriggeringController: IEmojiTriggeringController\n) => (text = '') => {\n  const selection = editor.selection as BaseRange;\n  const startPoint = editor.selection as BaseRange;\n  let currentText = text;\n\n  let endPoint = selection.anchor;\n  let nextPoint;\n  let repeat = emojiTriggeringController.getOptions().maxTextToSearch;\n\n  do {\n    if (!endPoint) break;\n\n    emojiTriggeringController.setText(currentText);\n    if (emojiTriggeringController.hasTriggeringMark) break;\n\n    nextPoint = getNextPoint(editor, endPoint);\n    const foundText = getFoundText(editor, startPoint, nextPoint);\n\n    endPoint = nextPoint!;\n    currentText = `${foundText}${text}`;\n\n    if (isBreakingCharInText(foundText)) {\n      emojiTriggeringController.reset();\n      break;\n    }\n  } while (--repeat > 0);\n};\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n/**\n * Constants.\n */\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar IS_MAC = () => typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\n\nvar MODIFIERS = {\n  alt: 'altKey',\n  control: 'ctrlKey',\n  meta: 'metaKey',\n  shift: 'shiftKey'\n};\n\n// We make this a function so it can be tested in describe block mocks with Jest.\nvar ALIASES = () => ({\n  add: '+',\n  break: 'pause',\n  cmd: 'meta',\n  command: 'meta',\n  ctl: 'control',\n  ctrl: 'control',\n  del: 'delete',\n  down: 'arrowdown',\n  esc: 'escape',\n  ins: 'insert',\n  left: 'arrowleft',\n  mod: IS_MAC() ? 'meta' : 'control',\n  opt: 'alt',\n  option: 'alt',\n  return: 'enter',\n  right: 'arrowright',\n  space: ' ',\n  spacebar: ' ',\n  up: 'arrowup',\n  win: 'meta',\n  windows: 'meta'\n});\n\nvar CODES = {\n  backspace: 8,\n  tab: 9,\n  enter: 13,\n  shift: 16,\n  control: 17,\n  alt: 18,\n  pause: 19,\n  capslock: 20,\n  escape: 27,\n  ' ': 32,\n  pageup: 33,\n  pagedown: 34,\n  end: 35,\n  home: 36,\n  arrowleft: 37,\n  arrowup: 38,\n  arrowright: 39,\n  arrowdown: 40,\n  insert: 45,\n  delete: 46,\n  meta: 91,\n  numlock: 144,\n  scrolllock: 145,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  '\\'': 222\n};\n\nfor (var f = 1; f < 20; f++) {\n  CODES['f' + f] = 111 + f;\n}\n\n/**\n * Is hotkey?\n */\n\nfunction isHotkey(hotkey, options, event) {\n  if (options && !('byKey' in options)) {\n    event = options;\n    options = null;\n  }\n\n  if (!Array.isArray(hotkey)) {\n    hotkey = [hotkey];\n  }\n\n  var array = hotkey.map(function (string) {\n    return parseHotkey(string, options);\n  });\n  var check = function check(e) {\n    return array.some(function (object) {\n      return compareHotkey(object, e);\n    });\n  };\n  var ret = event == null ? check : check(event);\n  return ret;\n}\n\nfunction isCodeHotkey(hotkey, event) {\n  return isHotkey(hotkey, event);\n}\n\nfunction isKeyHotkey(hotkey, event) {\n  return isHotkey(hotkey, { byKey: true }, event);\n}\n\n/**\n * Parse.\n */\n\nfunction parseHotkey(hotkey, options) {\n  var byKey = options && options.byKey;\n  var ret = {};\n\n  // Special case to handle the `+` key since we use it as a separator.\n  hotkey = hotkey.replace('++', '+add');\n  var values = hotkey.split('+');\n  var length = values.length;\n\n  // Ensure that all the modifiers are set to false unless the hotkey has them.\n\n  for (var k in MODIFIERS) {\n    ret[MODIFIERS[k]] = false;\n  }\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = values[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var value = _step.value;\n\n      var optional = value.endsWith('?') && value.length > 1;\n\n      if (optional) {\n        value = value.slice(0, -1);\n      }\n\n      var name = toKeyName(value);\n      var modifier = MODIFIERS[name];\n\n      if (length === 1 || !modifier) {\n        if (byKey) {\n          ret.key = name;\n        } else {\n          ret.which = toKeyCode(value);\n        }\n      }\n\n      if (modifier) {\n        ret[modifier] = optional ? null : true;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return ret;\n}\n\n/**\n * Compare.\n */\n\nfunction compareHotkey(object, event) {\n  for (var key in object) {\n    var expected = object[key];\n    var actual = void 0;\n\n    if (expected == null) {\n      continue;\n    }\n\n    if (key === 'key' && event.key != null) {\n      actual = event.key.toLowerCase();\n    } else if (key === 'which') {\n      actual = expected === 91 && event.which === 93 ? 91 : event.which;\n    } else {\n      actual = event[key];\n    }\n\n    if (actual == null && expected === false) {\n      continue;\n    }\n\n    if (actual !== expected) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Utils.\n */\n\nfunction toKeyCode(name) {\n  name = toKeyName(name);\n  var code = CODES[name] || name.toUpperCase().charCodeAt(0);\n  return code;\n}\n\nfunction toKeyName(name) {\n  name = name.toLowerCase();\n  name = ALIASES()[name] || name;\n  return name;\n}\n\n/**\n * Export.\n */\n\nexports.default = isHotkey;\nexports.isHotkey = isHotkey;\nexports.isCodeHotkey = isCodeHotkey;\nexports.isKeyHotkey = isKeyHotkey;\nexports.parseHotkey = parseHotkey;\nexports.compareHotkey = compareHotkey;\nexports.toKeyCode = toKeyCode;\nexports.toKeyName = toKeyName;","import { KeyboardEvent } from 'react';\nimport {\n  HandlerReturnType,\n  moveSelection,\n  PlateEditor,\n  Value,\n} from '@udecode/plate-core';\nimport isHotkey from 'is-hotkey';\nimport { Range } from 'slate';\n\n/**\n * TODO: move to core\n */\ntype KeyboardEventHandler = (event: KeyboardEvent) => HandlerReturnType;\n\ninterface MoveSelectionByOffsetOptions<V extends Value = Value> {\n  query?: (editor: PlateEditor<V>) => boolean;\n}\n\n// TODO: move to core\nconst moveSelectionByOffset: <V extends Value>(\n  editor: PlateEditor<V>,\n  options?: MoveSelectionByOffsetOptions<V>\n) => KeyboardEventHandler = (editor, { query = () => true } = {}) => (\n  event\n) => {\n  const { selection } = editor;\n\n  if (!selection || Range.isExpanded(selection) || !query(editor)) {\n    return false;\n  }\n\n  if (isHotkey('left', event)) {\n    event.preventDefault();\n    moveSelection(editor, { unit: 'offset', reverse: true });\n    return true;\n  }\n\n  if (isHotkey('right', event)) {\n    event.preventDefault();\n    moveSelection(editor, { unit: 'offset' });\n    return true;\n  }\n};\n// ------>\n\nexport const getOnKeyDownEmoji: <V extends Value>(\n  options?: MoveSelectionByOffsetOptions<V>\n) => (editor: PlateEditor<V>) => KeyboardEventHandler = (options) => (\n  editor\n) => (event) => {\n  return moveSelectionByOffset(editor, options)(event);\n};\n","import { comboboxActions } from '@udecode/plate-combobox';\nimport {\n  isCollapsed,\n  PlateEditor,\n  Value,\n  WithPlatePlugin,\n} from '@udecode/plate-core';\nimport { getFindTriggeringInput } from './handlers';\nimport { EmojiPlugin } from './types';\nimport { EmojiInlineIndexSearch } from './utils';\n\nexport const withEmoji = <\n  V extends Value = Value,\n  E extends PlateEditor<V> = PlateEditor<V>\n>(\n  editor: E,\n  {\n    options: { id, emojiTriggeringController },\n  }: WithPlatePlugin<EmojiPlugin, V, E>\n) => {\n  const emojiInlineIndexSearch = EmojiInlineIndexSearch.getInstance();\n\n  const findTheTriggeringInput = getFindTriggeringInput(\n    editor,\n    emojiTriggeringController!\n  );\n\n  const { apply, insertText } = editor;\n\n  editor.insertText = (text) => {\n    const { selection } = editor;\n    if (!selection || !isCollapsed(selection)) return insertText(text);\n\n    findTheTriggeringInput(text);\n\n    return insertText(text);\n  };\n\n  editor.apply = (operation) => {\n    apply(operation);\n\n    if (!emojiTriggeringController?.hasTriggeringMark) {\n      return;\n    }\n\n    switch (operation.type) {\n      case 'set_selection':\n        emojiTriggeringController!.reset();\n        comboboxActions.reset();\n        break;\n\n      case 'insert_text':\n        if (emojiTriggeringController!.isTriggering) {\n          const searchText = emojiTriggeringController!.getText();\n          comboboxActions.items(\n            emojiInlineIndexSearch.search(searchText).get()\n          );\n          comboboxActions.open({\n            activeId: id!,\n            text: '',\n            targetRange: editor.selection,\n          });\n        }\n        break;\n\n      case 'remove_text':\n        findTheTriggeringInput();\n        if (emojiTriggeringController!.isTriggering) {\n          const searchText = emojiTriggeringController!.getText();\n          comboboxActions.items(\n            emojiInlineIndexSearch.search(searchText).get()\n          );\n          comboboxActions.open({\n            activeId: id!,\n            text: '',\n            targetRange: editor.selection,\n          });\n          break;\n        }\n\n        emojiTriggeringController!.reset();\n        comboboxActions.reset();\n        break;\n    }\n  };\n\n  return editor;\n};\n","import { createPluginFactory } from '@udecode/plate-core';\nimport { EMOJI_TRIGGER, KEY_EMOJI } from './constants';\nimport { EmojiPlugin } from './types';\nimport { EmojiTriggeringController } from './utils';\nimport { withEmoji } from './withEmoji';\n\nexport const createEmojiPlugin = createPluginFactory<EmojiPlugin>({\n  key: KEY_EMOJI,\n  // handlers: {\n  //   onKeyDown: getOnKeyDownEmoji(),\n  // },\n  withOverrides: withEmoji,\n  options: {\n    trigger: EMOJI_TRIGGER,\n    createEmoji: (item) => item.data.emoji,\n    emojiTriggeringController: new EmojiTriggeringController(EMOJI_TRIGGER),\n  },\n  then: (\n    _,\n    { key, options: { trigger, createEmoji, emojiTriggeringController } }\n  ) => ({\n    options: {\n      id: key,\n      trigger,\n      createEmoji,\n      emojiTriggeringController,\n    },\n  }),\n});\n","import { ILocalStorage } from './LocalStorage.types';\n\nexport class LocalStorage<T> implements ILocalStorage<T> {\n  constructor(protected key: string, protected defaultValue: T) {}\n\n  set(value: any) {\n    window.localStorage.setItem(this.key, JSON.stringify(value));\n  }\n\n  get(): T {\n    let value = this.defaultValue;\n    const valueInLocalStorage = window.localStorage.getItem(this.key);\n\n    if (valueInLocalStorage) {\n      try {\n        value = JSON.parse(valueInLocalStorage);\n      } catch (error) {\n        window.localStorage.removeItem(this.key);\n      }\n    }\n\n    return value;\n  }\n}\n","import { DEFAULT_FREQUENTLY_USED_EMOJI } from '../constants';\nimport { EmojiCategory } from '../types';\nimport {\n  FrequentEmojis,\n  FrequentEmojiStorageProps,\n  IFrequentEmojiStorage,\n} from '../utils';\nimport { LocalStorage } from './LocalStorage';\n\nexport class FrequentEmojiStorage implements IFrequentEmojiStorage {\n  protected limit = 8;\n  protected prefix = 'emoji';\n  protected key = EmojiCategory.Frequent;\n  protected localStorage;\n\n  constructor(\n    props: FrequentEmojiStorageProps,\n    protected defaultValue = DEFAULT_FREQUENTLY_USED_EMOJI\n  ) {\n    this.limit = props.limit ?? this.limit;\n    const key = `${props.prefix ?? this.prefix}:${props.key ?? this.key}`;\n    this.localStorage = new LocalStorage(key, defaultValue);\n  }\n\n  update(emojiId: string) {\n    const prevEmojis = this.localStorage.get();\n    const count = prevEmojis![emojiId] ? prevEmojis[emojiId] + 1 : 1;\n\n    const emojis: FrequentEmojis = {\n      ...prevEmojis,\n      [emojiId]: count,\n    };\n\n    this.localStorage.set(emojis);\n\n    return emojis;\n  }\n\n  get(): FrequentEmojis {\n    const data = this.localStorage.get();\n    return Object.keys(data)\n      .sort((a, b) => data[b] - data[a])\n      .reduce(\n        (_sortedObj, key) => ({\n          ..._sortedObj,\n          [key]: data[key],\n        }),\n        {}\n      );\n  }\n\n  getList(): string[] {\n    return Object.keys(this.get()).splice(0, this.limit);\n  }\n\n  set(value: any) {\n    this.localStorage.set(value);\n  }\n}\n"],"names":["EmojiCategory","Activity","Custom","Flags","Foods","Frequent","Nature","Objects","People","Places","Symbols","KEY_EMOJI","EMOJI_TRIGGER","EMOJI_MAX_SEARCH_RESULT","EMOJI_TRIGGERING_CONTROLLER_OPTIONS","limitTriggeringChars","maxTextToSearch","defaultCategories","EmojiSettings","buttonSize","value","perLine","showFrequent","limit","categories","undefined","DEFAULT_FREQUENTLY_USED_EMOJI","grinning","kissing_heart","heart_eyes","pray","laughing","clap","joy","scream","rocket","see_no_evil","hugging_face","heart","NUM_OF_CATEGORIES","Object","values","length","i18n","search","clear","searchNoResultsTitle","searchNoResultsSubtitle","pick","searchResult","activity","custom","flags","foods","frequent","nature","objects","people","places","symbols","skins","choose","setVisibleSections","entries","visibleSections","entry","id","target","dataset","set","isIntersecting","getSectionInFocus","ratio","observeCategories","ancestorRef","emojiLibrary","setFocusedAndVisibleSections","observerOptions","root","current","threshold","Map","observer","IntersectionObserver","focusedSectionId","section","getGrid","sections","observe","EmojiTriggeringController","constructor","trigger","options","setText","text","hasTriggeringMark","isWithTriggeringMark","isTriggering","RegExp","test","getText","slice","getOptions","getTextSize","reset","Grid","addSection","sectionId","elements","setIndexRowStart","rowsCount","addElements","rowsNum","grid","sectionsIds","push","size","indexOf","Array","from","get","updateSection","has","updateElements","AGridSection","_id","createRootRef","start","_indexRowStart","_rowsNum","Math","ceil","initRows","rows","i","addRow","lastPosition","end","_root","getRows","EmojiFloatingGrid","createRef","EmojiGridSectionWithRoot","EmojiFloatingGridBuilder","localStorage","settings","addFrequent","getList","build","forEach","EmojiInlineLibrary","library","emojiMartData","_emojis","emojis","init","emoji","searchableString","createSearchableString","_keys","_hash","name","keywords","getName","join","toLowerCase","split","keys","getEmoji","getEmojiId","key","EmojiFloatingLibrary","initEmojis","getInstance","instance","categoriesLibrary","category","updateFrequentCategory","emojiId","update","focusedCategory","index","initialState","isOpen","searchValue","hasFound","isSearching","visibleCategories","frequentEmoji","EmojiPickerState","cache","dispatch","useReducer","state","action","type","payload","Error","getEmojiOnInsert","editor","item","createEmoji","getPlugin","withoutNormalizing","focusEditor","insertText","useEmojiPicker","indexSearch","closeOnSelect","refs","useRef","contentRoot","content","onToggle","useCallback","categoryId","handleSearchInput","input","String","replace","setSearch","clearSearch","onMouseOver","updateFrequentEmojis","onSelectEmoji","selectItem","data","native","handleCategoryClick","getSectionPositionToScrollIntoView","trashHold","contentRootScrollTop","scrollTop","contentRootTopPosition","getBoundingClientRect","top","sectionTopPosition","useEffect","AIndexSearch","createSearchResult","sortResultByScores","result","scores","score","sort","a","b","aScore","bScore","localeCompare","transform","maxResult","EmojiFloatingIndexSearch","EmojiInlineIndexSearch","getEmojiOnSelectItem","emojiTriggeringController","withoutMergingHistory","deleteText","distance","reverse","comboboxActions","getNextPoint","endPoint","getPointBefore","unit","getFoundText","getEditorString","getRange","isBreakingCharInText","getFindTriggeringInput","selection","startPoint","currentText","anchor","nextPoint","repeat","foundText","moveSelectionByOffset","query","event","Range","isExpanded","isHotkey","preventDefault","moveSelection","getOnKeyDownEmoji","withEmoji","emojiInlineIndexSearch","findTheTriggeringInput","apply","isCollapsed","operation","searchText","items","open","activeId","targetRange","createEmojiPlugin","createPluginFactory","withOverrides","then","_","LocalStorage","defaultValue","window","setItem","JSON","stringify","valueInLocalStorage","getItem","parse","error","removeItem","FrequentEmojiStorage","props","prefix","prevEmojis","count","reduce","_sortedObj","splice"],"mappings":"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"}