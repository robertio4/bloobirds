import { Flow } from '.'
import { getOrderedNodeKeys } from './utils'

describe('flows/utils', () => {
  it('should return nodes in order layer by layer', () => {
    const flow = {
      nodes: {
        'root-1': {
          links: [
            {
              key: 'child-level-1-1',
            },
            {
              key: 'child-level-1-2',
            },
          ],
        },
        'root-2': {
          links: [
            {
              key: 'child-level-1-2',
            },
            {
              key: 'child-level-1-3',
            },
          ],
        },
        'child-level-1-1': {
          links: [
            {
              key: 'child-level-2-1',
            },
          ],
        },
        'child-level-1-2': {},
        'child-level-1-3': {
          links: [
            {
              key: 'child-level-2-1',
            },
            {
              key: 'child-level-2-2',
            },
          ],
        },
        'child-level-2-1': {},
        'child-level-2-2': {},
      },
    }

    const keysInOrder = [
      'root-1',
      'root-2',
      'child-level-1-1',
      'child-level-1-2',
      'child-level-1-3',
      'child-level-2-1',
      'child-level-2-2',
    ]

    expect(getOrderedNodeKeys(flow as any as Flow)).toEqual(keysInOrder)
  })
})
