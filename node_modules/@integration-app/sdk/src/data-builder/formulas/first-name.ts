import { DataBuilderFormulaType, processValue } from '.'
import { DataBuilderFormulaBase } from './base'
import humanparser from 'humanparser'
import { DataBuilderContext } from '../context'

export class DataBuilderFormulaFirstName extends DataBuilderFormulaBase {
  constructor(public value: any) {
    super(DataBuilderFormulaType.FIRST_NAME, value)
  }

  getValue(context: DataBuilderContext) {
    const value = processValue(this.value, context)
    const { firstName } = humanparser.parseName(value?.toString() ?? '')
    return firstName
  }

  getSchema() {
    return { type: 'string' }
  }
}
