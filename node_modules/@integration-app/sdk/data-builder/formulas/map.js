"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.DataBuilderFormulaMap = void 0;
const tslib_1 = require("tslib");
const lodash_1 = tslib_1.__importDefault(require("lodash"));
const _1 = require(".");
const base_1 = require("./base");
class DataBuilderFormulaMap extends base_1.DataBuilderFormulaBase {
    constructor(value) {
        super(_1.DataBuilderFormulaType.MAP, value);
        this.value = value;
    }
    getValue(context) {
        if (!this.value || typeof this.value !== 'object') {
            return;
        }
        const value = (0, _1.processValue)(this.value.value, context);
        if (Array.isArray(this.value.mapping)) {
            for (const mappingItem of this.value.mapping) {
                const from = (0, _1.processValue)(mappingItem.from, context);
                if (lodash_1.default.isEqual(value, from)) {
                    return (0, _1.processValue)(mappingItem.to, context);
                }
            }
        }
        return (0, _1.processValue)(this.value.default, context);
    }
    getSchema(variablesSchema) {
        return (0, _1.getSchemaFromValue)(this.value.value, variablesSchema);
    }
}
exports.DataBuilderFormulaMap = DataBuilderFormulaMap;
//# sourceMappingURL=map.js.map